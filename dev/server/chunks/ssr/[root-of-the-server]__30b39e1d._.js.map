{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/lautylopez/Desktop/TRABAJO/La%20Fuga/SISTEMA%20DE%20GESTION%20DE%20PRECIOS/frontend-design-concept/contexts/auth-context.tsx"],"sourcesContent":["\"use client\"\n\nimport {\n  createContext,\n  useContext,\n  useState,\n  useEffect,\n  useCallback,\n  useRef,\n  ReactNode,\n} from \"react\"\nimport { useRouter } from \"next/navigation\"\n\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:8000\"\n\n// Cookie helper functions\nfunction setCookie(name: string, value: string, days: number = 7) {\n  const expires = new Date()\n  expires.setTime(expires.getTime() + days * 24 * 60 * 60 * 1000)\n  document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/`\n}\n\nfunction deleteCookie(name: string) {\n  document.cookie = `${name}=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/`\n}\n\ninterface User {\n  id: number\n  email: string\n  name: string\n  picture: string | null\n  role: string\n  created_at: string | null\n  last_login: string | null\n}\n\ninterface AuthContextType {\n  user: User | null\n  token: string | null\n  loading: boolean\n  login: () => void\n  logout: () => void\n  setToken: (token: string) => Promise<boolean>\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<User | null>(null)\n  const [token, setTokenState] = useState<string | null>(null)\n  const [loading, setLoading] = useState(true)\n  const router = useRouter()\n  const initializedRef = useRef(false)\n\n  // Load token from localStorage on mount and sync with cookie\n  useEffect(() => {\n    if (initializedRef.current) return\n    initializedRef.current = true\n\n    const storedToken = localStorage.getItem(\"access_token\")\n    if (storedToken) {\n      setTokenState(storedToken)\n      setCookie(\"access_token\", storedToken, 7)\n      fetchUser(storedToken)\n    } else {\n      setLoading(false)\n    }\n  }, [])\n\n  const fetchUser = async (accessToken: string): Promise<boolean> => {\n    try {\n      const response = await fetch(`${API_URL}/auth/me`, {\n        headers: {\n          Authorization: `Bearer ${accessToken}`,\n        },\n      })\n\n      if (response.ok) {\n        const userData = await response.json()\n        setUser(userData)\n        setLoading(false)\n        return true\n      } else {\n        localStorage.removeItem(\"access_token\")\n        deleteCookie(\"access_token\")\n        setTokenState(null)\n        setUser(null)\n        setLoading(false)\n        return false\n      }\n    } catch (error) {\n      console.error(\"Error fetching user:\", error)\n      localStorage.removeItem(\"access_token\")\n      deleteCookie(\"access_token\")\n      setTokenState(null)\n      setUser(null)\n      setLoading(false)\n      return false\n    }\n  }\n\n  const login = useCallback(() => {\n    window.location.href = `${API_URL}/auth/login/google`\n  }, [])\n\n  const logout = useCallback(() => {\n    localStorage.removeItem(\"access_token\")\n    deleteCookie(\"access_token\")\n    setTokenState(null)\n    setUser(null)\n    router.push(\"/login\")\n  }, [router])\n\n  const setToken = useCallback(async (newToken: string): Promise<boolean> => {\n    localStorage.setItem(\"access_token\", newToken)\n    setCookie(\"access_token\", newToken, 7)\n    setTokenState(newToken)\n    return await fetchUser(newToken)\n  }, [])\n\n  return (\n    <AuthContext.Provider\n      value={{\n        user,\n        token,\n        loading,\n        login,\n        logout,\n        setToken,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext)\n  if (context === undefined) {\n    throw new Error(\"useAuth must be used within an AuthProvider\")\n  }\n  return context\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AASA;AAXA;;;;AAaA,MAAM,UAAU,6DAAmC;AAEnD,0BAA0B;AAC1B,SAAS,UAAU,IAAY,EAAE,KAAa,EAAE,OAAe,CAAC;IAC9D,MAAM,UAAU,IAAI;IACpB,QAAQ,OAAO,CAAC,QAAQ,OAAO,KAAK,OAAO,KAAK,KAAK,KAAK;IAC1D,SAAS,MAAM,GAAG,GAAG,KAAK,CAAC,EAAE,MAAM,SAAS,EAAE,QAAQ,WAAW,GAAG,OAAO,CAAC;AAC9E;AAEA,SAAS,aAAa,IAAY;IAChC,SAAS,MAAM,GAAG,GAAG,KAAK,8CAA8C,CAAC;AAC3E;AAqBA,MAAM,4BAAc,IAAA,sVAAa,EAA8B;AAExD,SAAS,aAAa,EAAE,QAAQ,EAA2B;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iVAAQ,EAAc;IAC9C,MAAM,CAAC,OAAO,cAAc,GAAG,IAAA,iVAAQ,EAAgB;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iVAAQ,EAAC;IACvC,MAAM,SAAS,IAAA,+QAAS;IACxB,MAAM,iBAAiB,IAAA,+UAAM,EAAC;IAE9B,6DAA6D;IAC7D,IAAA,kVAAS,EAAC;QACR,IAAI,eAAe,OAAO,EAAE;QAC5B,eAAe,OAAO,GAAG;QAEzB,MAAM,cAAc,aAAa,OAAO,CAAC;QACzC,IAAI,aAAa;YACf,cAAc;YACd,UAAU,gBAAgB,aAAa;YACvC,UAAU;QACZ,OAAO;YACL,WAAW;QACb;IACF,GAAG,EAAE;IAEL,MAAM,YAAY,OAAO;QACvB,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,GAAG,QAAQ,QAAQ,CAAC,EAAE;gBACjD,SAAS;oBACP,eAAe,CAAC,OAAO,EAAE,aAAa;gBACxC;YACF;YAEA,IAAI,SAAS,EAAE,EAAE;gBACf,MAAM,WAAW,MAAM,SAAS,IAAI;gBACpC,QAAQ;gBACR,WAAW;gBACX,OAAO;YACT,OAAO;gBACL,aAAa,UAAU,CAAC;gBACxB,aAAa;gBACb,cAAc;gBACd,QAAQ;gBACR,WAAW;gBACX,OAAO;YACT;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,wBAAwB;YACtC,aAAa,UAAU,CAAC;YACxB,aAAa;YACb,cAAc;YACd,QAAQ;YACR,WAAW;YACX,OAAO;QACT;IACF;IAEA,MAAM,QAAQ,IAAA,oVAAW,EAAC;QACxB,OAAO,QAAQ,CAAC,IAAI,GAAG,GAAG,QAAQ,kBAAkB,CAAC;IACvD,GAAG,EAAE;IAEL,MAAM,SAAS,IAAA,oVAAW,EAAC;QACzB,aAAa,UAAU,CAAC;QACxB,aAAa;QACb,cAAc;QACd,QAAQ;QACR,OAAO,IAAI,CAAC;IACd,GAAG;QAAC;KAAO;IAEX,MAAM,WAAW,IAAA,oVAAW,EAAC,OAAO;QAClC,aAAa,OAAO,CAAC,gBAAgB;QACrC,UAAU,gBAAgB,UAAU;QACpC,cAAc;QACd,OAAO,MAAM,UAAU;IACzB,GAAG,EAAE;IAEL,qBACE,8WAAC,YAAY,QAAQ;QACnB,OAAO;YACL;YACA;YACA;YACA;YACA;YACA;QACF;kBAEC;;;;;;AAGP;AAEO,SAAS;IACd,MAAM,UAAU,IAAA,mVAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT"}},
    {"offset": {"line": 146, "column": 0}, "map": {"version":3,"sources":["file:///Users/lautylopez/Desktop/TRABAJO/La%20Fuga/SISTEMA%20DE%20GESTION%20DE%20PRECIOS/frontend-design-concept/components/providers.tsx"],"sourcesContent":["\"use client\"\n\nimport { AuthProvider } from \"@/contexts/auth-context\"\n\nexport function Providers({ children }: { children: React.ReactNode }) {\n  return <AuthProvider>{children}</AuthProvider>\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIO,SAAS,UAAU,EAAE,QAAQ,EAAiC;IACnE,qBAAO,8WAAC,4IAAY;kBAAE;;;;;;AACxB"}}]
}